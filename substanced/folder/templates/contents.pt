<div metal:use-macro="h.macros()['master']">

  <div tal:omit-tag="" metal:fill-slot="head-more">
    <script type="text/javascript">
      function toggleChecked(status) {
          $("#choices input").each( function() {
             if (!$(this).attr("disabled")) {
               $(this).attr("checked",status);
             }
         })};
    </script>
  </div>

  <div metal:fill-slot="main">
     <form action="@@delete_folder_contents" method="POST">

      <fieldset>

      <div class="pagination" tal:condition="batchinfo['required']">
        <ul tal:define="first_url batchinfo['first_url'];
                        prev_url batchinfo['prev_url'];
                        next_url batchinfo['next_url'];
                        last_url batchinfo['last_url'];
                        num batchinfo['num'];
                        last batchinfo['last'];">
          <li tal:attributes="class not first_url and 'disabled'" ><a 
                 href="${first_url}">&laquo;</a></li>
          <li tal:attributes="class not prev_url and 'disabled'"><a 
                 href="${prev_url}">&larr;</a></li>
          <li class="disabled"><a href="#">page ${num+1} of ${last+1}</a></li>
          <li tal:attributes="class not next_url and 'disabled'"><a  
                 href="${next_url}">&rarr;</a></li>
          <li tal:attributes="class not last_url and 'disabled'" ><a 
                href="${last_url}">&raquo;</a></li>
        </ul>
      </div>

      <h2 tal:condition="not batchinfo['batch']">No items</h2>

      <div tal:define="batch batchinfo['batch']"
           tal:condition="batch">

        <label class="checkbox" for="selectall">
          <input type="checkbox" onclick="toggleChecked(this.checked)"/>
          -- all --
        </label>

        <div id="choices">

          <tal:loop tal:repeat="choice batch">
            <tal:block condition="choice['viewable']">
              <label class="checkbox" for="delete-${repeat.choice.index}">
                <i class="${choice['icon']}"> </i>
                <input tal:attributes="disabled not choice['deletable']"
                       type="checkbox"
                       name="delete"
                       value="${choice['name']}"
                       id="delete-${repeat.choice.index}"/>
                <a href="${choice['url']}">${choice['name']}</a>
              </label>
            </tal:block>
          </tal:loop>

        </div>

      </div>

      <input type="hidden" name="csrf_token" 
             value="${request.session.get_csrf_token()}"/>

      <div class="form-actions">
        <button
            id="delete"
            name="form.delete"
            type="submit"
            class="btn btn-primary"
            value="delete">
          Delete
        </button>
        <div class="btn-group pull-right" tal:condition="addables">
          <a class="btn btn-info" 
             href="${request.mgmt_path(context, '@@add')}"><i 
             class="icon-plus-sign icon-white"></i>Add</a>
          <a class="btn btn-info dropdown-toggle" 
              data-toggle="dropdown" href="#"><span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li tal:repeat="addable addables">
               <a href="${addable['url']}"><i 
              class="${addable['icon']}"></i> ${addable['type_name']}</a></li>
          </ul>
        </div>
      </div>

      </fieldset>
     </form>

  </div>

</div>
